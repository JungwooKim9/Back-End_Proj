<!DOCTYPE html>
<html lnag="ko">
<head>
    <meta charset="UTF-8">
    <title>회원가입</title>
    <link rel="stylesheet" href="/css/join.css">

</head>
<body>
<!-- header -->
<div id="header">
    <div class="join_text">회원 가입</div>
</div>


<!-- wrapper -->
<div id="wrapper">

    <!-- content-->
    <div id="content">

        <form action="/member/join" method="post">
        <!-- ID -->
        <div>
            <h3 class="join_title">
                <label for="id">아이디(이메일)</label>
            </h3>
            <span class="box">
                        <input type="text" name="memberEmail" id="memberEmail" onkeyup="emailCheck()" class="int" maxlength="20">
                        <span class="step_url"></span>
                    </span>
        </div>
            <div id="check-email"></div>


        <!-- PW1 -->
        <div>
            <h3 class="join_title"><label for="pswd1">비밀번호</label></h3>
            <span class="box int_pass">
                        <input type="password" name="memberPassword" id="pswd1" class="int" maxlength="20">
                        <span id="alertTxt">사용불가</span>
                    </span>
            <span class="error_next_box"></span>
        </div>

        <!-- PW2 -->
        <div>
            <h3 class="join_title"><label for="pswd2">비밀번호 확인</label></h3>
            <span class="box int_pass_check">
                        <input type="password" name="passwordConfirm" id="pswd2" onkeyup="passwordCheck()" class="int" maxlength="20">
                    </span>
            <span class="error_next_box"></span>
        </div>

            <div id="check-pswd"></div>

        <!-- NAME -->
        <div>
            <h3 class="join_title"><label for="name">이름</label></h3>
            <span class="box int_name">
                        <input type="text" name="memberName" id="name" class="int" maxlength="20">
                    </span>
            <span class="error_next_box"></span>
        </div>

        <!-- BIRTH -->
        <div>
            <h3 class="join_title"><label for="yy">생년월일</label></h3>

            <div id="bir_wrap">

                <input type="hidden" name="memberBirthDate">

                <!-- BIRTH_YY -->
                <div id="bir_yy">
                            <span class="box">
                                <input type="text" id="yy" class="int" maxlength="4" placeholder="년(4자)">
                            </span>
                </div>

                <!-- BIRTH_MM -->
                <div id="bir_mm">
                            <span class="box">
                                <select id="mm">
                                    <option>월</option>
                                    <option value="01">1</option>
                                    <option value="02">2</option>
                                    <option value="03">3</option>
                                    <option value="04">4</option>
                                    <option value="05">5</option>
                                    <option value="06">6</option>
                                    <option value="07">7</option>
                                    <option value="08">8</option>
                                    <option value="09">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                </select>
                            </span>
                </div>

                <!-- BIRTH_DD -->
                <div id="bir_dd">
                            <span class="box">
                                <select id="dd">
                                    <option>일</option>
                                    <option value="01">1</option>
                                    <option value="02">2</option>
                                    <option value="03">3</option>
                                    <option value="04">4</option>
                                    <option value="05">5</option>
                                    <option value="06">6</option>
                                    <option value="07">7</option>
                                    <option value="08">8</option>
                                    <option value="09">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                </select>
                            </span>
                </div>

            </div>
            <span class="error_next_box"></span>
        </div>

        <!-- MOBILE -->
        <div>
            <h3 class="join_title"><label for="phoneNo">휴대전화</label></h3>
            <span class="box int_mobile">
                        <input type="tel" name="memberPhoneNum" id="mobile" class="int" maxlength="16" placeholder="전화번호 입력">
                    </span>
            <span class="error_next_box"></span>
        </div>


        <!-- JOIN BTN-->
        <div class="btn_area">
            <button type="button submit" id="btnJoin">
                <span>가입하기</span>
            </button>
        </div>
        </form>


    </div>
    <!-- content-->

</div>
<!-- wrapper -->
<script>
    // 버튼 클릭 이벤트를 처리하는 함수
    document.getElementById("btnJoin").addEventListener("click", function () {
        // 각 입력 상자에서 값을 가져오기
        var year = document.getElementById("yy").value;
        var month = document.getElementById("mm").value;
        var day = document.getElementById("dd").value;

        // 입력 값을 하나의 문자열로 합치기
        var birthDate = year + '/' + month + '/' + day;

        console.log("생년월일: " + birthDate);

        // 데이터베이스로 전송하는 코드를 추가
        // 값을 가져온 후 name 속성으로 복사
        var memberBirthDateInput = document.getElementsByName("memberBirthDate")[0];
        memberBirthDateInput.value = birthDate;
    });
</script>

<script th:inline="javascript">
    const passwordCheck = () => {
        const password1 = document.getElementById("pswd1").value;
        const password2 = document.getElementById("pswd2").value;
        const checkResult = document.getElementById("check-pswd");

        if (password1 == password2) {
            console.log("사용 가능한 이메일");
            checkResult.style.color = "green";
            checkResult.innerHTML = "비밀번호 확인되었습니다.";
        } else {
            console.log("이미 사용중인 이메일");
            checkResult.innerHTML = "비밀번호가 다릅니다.";
            checkResult.style.color = "red";
        }
    }
</script>

<script th:inline="javascript">
    const emailCheck = () => {
        const email = document.getElementById("memberEmail").value;
        const checkResult = document.getElementById("check-email");
        console.log("입력값: ", email);
        $.ajax({
            // 요청방식: post, url: "email-check", 데이터: 이메일
            type: "post",
            url: "/member/email-check",
            data: {
                "memberEmail": email
            },
            success: function (res) {
                console.log("요청성공", res);
                if (res == "ok") {
                    console.log("사용 가능한 이메일");
                    checkResult.style.color = "green";
                    checkResult.innerHTML = "사용 가능한 이메일";
                } else {
                    console.log("이미 사용중인 이메일");
                    checkResult.innerHTML = "이미 사용중인 이메일";
                    checkResult.style.color = "red";
                }
            },
            error: function (err) {
                console.log("에러발생", err);
            }
        });
    }
</script>

</body>
</html>